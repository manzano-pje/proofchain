<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ClinicX - Mocked SaaS (Login + Dashboard)</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#f5f8ff;--card:#ecf4f7;--primary:#2b7cff;--muted:#6b7280;--radius:12px}
    *{box-sizing:border-box;margin:0;padding:0;font-family:Inter,system-ui,Arial}
    body{background:var(--bg);color:#09101a}
    .center{display:flex;align-items:center;justify-content:center;height:100vh}

    /* Login */
    .login-box{width:420px;background:var(--card);border-radius:14px;padding:28px;box-shadow:0 8px 24px rgba(16,24,40,0.08)}
    .brand{display:flex;gap:12px;align-items:center;margin-bottom:18px}
    .logo{width:48px;height:48px;border-radius:10px;background:linear-gradient(135deg,var(--primary),#1a5bd8);display:flex;align-items:center;justify-content:center;color:white;font-weight:700}
    .h1{font-size:20px;font-weight:700}
    .muted{color:var(--muted);font-size:13px;margin-bottom:18px}
    .form-row{display:flex;flex-direction:column;gap:8px;margin-bottom:12px}
    input{padding:10px 12px;border-radius:8px;border:1px solid #e6eef6}
    .btn{background:var(--primary);color:white;padding:10px 14px;border:none;border-radius:10px;font-weight:700;cursor:pointer}
    .link{color:var(--primary);cursor:pointer}

    /* App layout */
    .wrap{display:flex;height:100vh}
    .sidebar{width:260px;background:var(--card);padding:22px;border-right:1px solid #eef3fb}
    .brand-small{display:flex;align-items:center;gap:10px;margin-bottom:18px}
    .nav{display:flex;flex-direction:column;gap:8px}
    .nav button{background:transparent;border:none;padding:10px;border-radius:8px;text-align:left;cursor:pointer;color:var(--muted);font-weight:600}
    .nav button.active{background:linear-gradient(90deg,rgba(43,124,255,0.07),transparent);color:var(--primary)}
    .main{flex:1;padding:24px;overflow:auto}
    .header{display:flex;justify-content:space-between;align-items:center;margin-bottom:18px}
    .cards{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px
    }
    .card{
      background:var(--card);
      padding:14px;
      border-radius:12px;
      box-shadow:0 6px 18px rgba(16,24,40,0.5)}
    table{width:100%;border-collapse:collapse}
    th,td{padding:10px;text-align:left;border-bottom:1px solid #f0f4f8}
    .small{font-size:13px;color:var(--muted)}

    /* modal */
    .modal-bg{position:fixed;inset:0;background:rgba(3,8,18,0.45);display:none;align-items:center;justify-content:center}
    .modal{width:560px;background:var(--card);padding:18px;border-radius:12px}
    .row{display:flex;gap:8px}
    .col{flex:1}

    @media(max-width:900px){.sidebar{display:none}.wrap{display:block}.main{padding:12px}}
  </style>
</head>
<body>

<!-- LOGIN PAGE -->
<div id="loginPage" class="center">
  <div class="login-box">
    <div class="brand">
      <div class="logo">CX</div>
      <div>
        <div class="h1">ClinicX</div>
        <div class="small muted">Sistema de Agendamentos - Mock</div>
      </div>
    </div>

    <div class="muted">Acesse com um usuário de teste para simular o sistema.</div>
    <div style="height:12px"></div>
    <div class="form-row">
      <label class="small">E-mail</label>
      <input id="email" placeholder="admin@clinica.test" value="admin@clinica.test" />
    </div>
    <div class="form-row">
      <label class="small">Senha</label>
      <input id="password" type="password" placeholder="senha" value="admin123" />
    </div>
    <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px">
      <div class="small"><label><input id="remember" type="checkbox" /> Lembrar</label></div>
      <button class="btn" onclick="doLogin()">Entrar</button>
    </div>

    <div style="margin-top:12px;text-align:center;color:var(--muted);font-size:13px">
      Usuário de teste: <strong>admin@clinica.test</strong> / senha: <strong>admin123</strong>
    </div>
  </div>
</div>

<!-- APP LAYOUT -->
<div id="app" class="wrap" style="display:none">
  <aside class="sidebar">
    <div class="brand-small">
      <div class="logo" style="width:40px;height:40px">CX</div>
      <div>
        <strong>ClinicX</strong>
        <div class="small muted">Agendamentos</div>
      </div>
    </div>
    <nav class="nav">
      <button onclick="route('dashboard', this)" class="active">Painel</button>
      <button onclick="route('agenda', this)">Agenda</button>
      <button onclick="route('pacientes', this)">Pacientes</button>
      <button onclick="route('profissionais', this)">Profissionais</button>
      <button onclick="route('financeiro', this)">Financeiro</button>
      <button onclick="route('config', this)">Configurações</button>
      <button onclick="logout()" style="margin-top:18px;color:#d9534f">Sair</button>
    </nav>
  </aside>

  <main class="main">
    <div class="header">
      <div>
        <div style="font-size:20px;font-weight:700">Painel</div>
        <div class="small muted">Visão geral do dia</div>
      </div>
      <div style="display:flex;gap:12px;align-items:center">
        <input id="quickSearch" placeholder="Pesquisar..." style="padding:8px 10px;border-radius:10px;border:1px solid #e8eef8" oninput="quickSearch()" />
        <div style="width:40px;height:40px;border-radius:10px;background:linear-gradient(135deg,var(--primary),#1a5bd8);display:flex;align-items:center;justify-content:center;color:white">AD</div>
      </div>
    </div>

    <div id="view-dashboard">
      <div class="cards">
        <div class="card"><div class="small">Consultas Hoje</div><div style="font-size:20px;font-weight:700;margin-top:6px" id="kpi-today">0</div></div>
        <div class="card"><div class="small">Pacientes</div><div style="font-size:20px;font-weight:700;margin-top:6px" id="kpi-patients">0</div></div>
        <div class="card"><div class="small">Faturamento (mês)</div><div style="font-size:20px;font-weight:700;margin-top:6px" id="kpi-revenue">R$ 0,00</div></div>
      </div>

      <div style="height:18px"></div>

      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
          <div style="font-weight:700">Agenda do Dia</div>
          <div><button class="btn" onclick="openModal('appt')">Novo Agendamento</button></div>
        </div>

        <table>
          <thead><tr><th>Horário</th><th>Paciente</th><th>Serviço</th><th>Profissional</th><th>Ações</th></tr></thead>
          <tbody id="table-agenda"></tbody>
        </table>
      </div>
    </div>

    <div id="view-agenda" style="display:none">
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
          <div style="font-weight:700">Agenda Completa</div>
          <div><button class="btn" onclick="openModal('appt')">Adicionar</button></div>
        </div>
        <table>
          <thead><tr><th>Data</th><th>Horário</th><th>Paciente</th><th>Profissional</th><th>Status</th></tr></thead>
          <tbody id="table-all-agenda"></tbody>
        </table>
      </div>
    </div>

    <div id="view-pacientes" style="display:none">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
        <div style="font-weight:700">Pacientes</div>
        <div><button class="btn" onclick="openModal('patient')">Novo Paciente</button></div>
      </div>

      <div class="card">
        <table>
          <thead><tr><th>Nome</th><th>Telefone</th><th>Data Nasc.</th><th>Ações</th></tr></thead>
          <tbody id="table-patients"></tbody>
        </table>
      </div>
    </div>

    <div id="view-profissionais" style="display:none">
      <div class="card"><div style="font-weight:700;margin-bottom:10px">Profissionais</div><div id="table-professionals">(Lista de profissionais)</div></div>
    </div>

    <div id="view-financeiro" style="display:none">
      <div class="card"><div style="font-weight:700;margin-bottom:10px">Financeiro</div><div id="finance-summary">Resumo financeiro (mock)</div></div>
    </div>

    <div id="view-config" style="display:none">
      <div class="card"><div style="font-weight:700;margin-bottom:10px">Configurações</div>
      <div style="margin-top:8px" class="small muted">Ajustes de conta e preferências</div></div>
    </div>

  </main>
</div>

<!-- Modal templates -->
<div class="modal-bg" id="modalAppt">
  <div class="modal">
    <h3>Novo Agendamento</h3>
    <div class="row" style="margin-top:8px">
      <div class="col"><label class="small">Paciente</label><input id="m_appt_patient" placeholder="Nome do paciente" /></div>
      <div class="col"><label class="small">Profissional</label><select id="m_appt_prof"></select></div>
    </div>
    <div class="row" style="margin-top:8px">
      <div class="col"><label class="small">Data</label><input id="m_appt_date" type="date" /></div>
      <div class="col"><label class="small">Horário</label><input id="m_appt_time" type="time" /></div>
    </div>
    <div style="display:flex;justify-content:flex-end;gap:8px;margin-top:12px"><button class="btn" onclick="closeModal('appt')">Cancelar</button><button class="btn" onclick="saveAppt()">Salvar</button></div>
  </div>
</div>

<div class="modal-bg" id="modalPatient">
  <div class="modal">
    <h3>Novo Paciente</h3>
    <div class="form-row"><label class="small">Nome</label><input id="m_pat_name" /></div>
    <div class="row"><div class="col"><label class="small">Data Nasc.</label><input id="m_pat_birth" type="date" /></div><div class="col"><label class="small">Telefone</label><input id="m_pat_phone" /></div></div>
    <div style="display:flex;justify-content:flex-end;gap:8px;margin-top:12px"><button class="btn" onclick="closeModal('patient')">Cancelar</button><button class="btn" onclick="savePatient()">Salvar</button></div>
  </div>
</div>

<script>
/* ---------- MOCKED API (localStorage backed) ----------
  Endpoints (mocked):
  POST /auth/login -> {email, password} => { token }
  POST /auth/logout -> invalidates token

  GET /patients -> list
  POST /patients -> create
  PUT /patients/{id} -> update
  DELETE /patients/{id} -> delete

  GET /appointments -> list
  POST /appointments -> create
  PUT /appointments/{id} -> update
  DELETE /appointments/{id} -> delete

  GET /professionals -> list
  POST /professionals -> create

  GET /reports/summary -> summary
*/

// Utility
const storageKey = 'clinicx_mock_db_v1';
function loadDB(){
  const raw = localStorage.getItem(storageKey);
  if(raw) return JSON.parse(raw);
  // initial seed
  const seed = {
    users:[{id:1,email:'admin@clinica.test',password:'admin123',name:'Admin',role:'ADMIN'}],
    patients:[{id:1,name:'Maria Silva',birth:'1988-03-12',phone:'(11) 98888-1111'}],
    professionals:[{id:1,name:'Dra. Ana'},{id:2,name:'Dr. Paulo'}],
    appointments:[{id:1,date:today(),time:'09:00',patient:'Maria Silva',professional:'Dra. Ana',service:'Avaliação',status:'CONFIRMADO'}]
  };
  localStorage.setItem(storageKey,JSON.stringify(seed));
  return seed;
}
function saveDB(db){ localStorage.setItem(storageKey,JSON.stringify(db)); }
function today(){ const d=new Date(); return d.toISOString().slice(0,10); }

let DB = loadDB();

/* --------- AUTH --------- */
function doLogin(){
  const email = document.getElementById('email').value;
  const pwd = document.getElementById('password').value;
  const user = DB.users.find(u=>u.email===email && u.password===pwd);
  if(!user){ alert('Credenciais inválidas'); return; }
  // create fake token
  const token = btoa(JSON.stringify({id:user.id,email:user.email,exp:Date.now()+3600*1000}));
  localStorage.setItem('clinicx_token',token);
  showApp();
}
function logout(){ localStorage.removeItem('clinicx_token'); location.reload(); }
function isAuthenticated(){ return !!localStorage.getItem('clinicx_token'); }

/* --------- ROUTING & UI --------- */
function showApp(){ document.getElementById('loginPage').style.display='none'; document.getElementById('app').style.display='flex'; renderDashboard(); populateProfessionalsSelect(); }
function route(view,btn){ document.querySelectorAll('.nav button').forEach(b=>b.classList.remove('active')); if(btn) btn.classList.add('active'); document.querySelectorAll('#app .main > div').forEach(v=>v.style.display='none');
  const id = 'view-' + view;
  const el = document.getElementById(id);
  if(el) el.style.display='block';
  if(view==='dashboard') renderDashboard(); if(view==='agenda') renderAgendaAll(); if(view==='pacientes') renderPatients();
}

/* --------- MODALS --------- */
function openModal(type){ if(type==='appt'){document.getElementById('modalAppt').style.display='flex';} if(type==='patient'){document.getElementById('modalPatient').style.display='flex';} }
function closeModal(type){ if(type==='appt'){document.getElementById('modalAppt').style.display='none';} if(type==='patient'){document.getElementById('modalPatient').style.display='none';} }

/* --------- PATIENTS API (mock) --------- */
function apiGetPatients(){ return DB.patients; }
function apiCreatePatient(payload){ const id = Date.now(); DB.patients.push({id:id,...payload}); saveDB(DB); return id; }
function renderPatients(){ const rows = apiGetPatients().map(p=>`<tr><td>${p.name}</td><td>${p.phone||''}</td><td>${p.birth||''}</td><td><button onclick="viewPatient(${p.id})">Ver</button></td></tr>`).join(''); document.getElementById('table-patients').innerHTML = rows; document.getElementById('kpi-patients').innerText = DB.patients.length; }
function viewPatient(id){ const p = DB.patients.find(x=>x.id===id); alert('Paciente: '+p.name+'\nTelefone: '+p.phone); }
function savePatient(){ const name = document.getElementById('m_pat_name').value; const birth = document.getElementById('m_pat_birth').value; const phone = document.getElementById('m_pat_phone').value; if(!name){alert('Nome obrigatório');return;} apiCreatePatient({name, birth, phone}); closeModal('patient'); renderPatients(); }

/* --------- PROFESSIONALS --------- */
function apiGetProfessionals(){ return DB.professionals; }
function populateProfessionalsSelect(){ const sel = document.getElementById('m_appt_prof'); sel.innerHTML = DB.professionals.map(p=>`<option>${p.name}</option>`).join(''); document.getElementById('table-professionals').innerText = DB.professionals.map(p=>p.name).join(', '); }

/* --------- APPOINTMENTS --------- */
function apiGetAppointments(){ return DB.appointments; }
function apiCreateAppointment(payload){ const id = Date.now(); DB.appointments.push({id:id,...payload}); saveDB(DB); return id; }
function renderDashboard(){ // today's appointments
  const todayStr = today(); const list = DB.appointments.filter(a=>a.date===todayStr);
  document.getElementById('kpi-today').innerText = list.length; document.getElementById('table-agenda').innerHTML = list.map(a=>`<tr><td>${a.time}</td><td>${a.patient}</td><td>${a.service||''}</td><td>${a.professional}</td><td><button onclick=editAppt(${a.id})>Editar</button></td></tr>`).join('');
  document.getElementById('kpi-revenue').innerText = 'R$ 0,00';
}
function renderAgendaAll(){ const rows = DB.appointments.map(a=>`<tr><td>${a.date}</td><td>${a.time}</td><td>${a.patient}</td><td>${a.professional}</td><td>${a.status||'PENDENTE'}</td></tr>`).join(''); document.getElementById('table-all-agenda').innerHTML = rows; }
function saveAppt(){ const patient = document.getElementById('m_appt_patient').value; const prof = document.getElementById('m_appt_prof').value; const date = document.getElementById('m_appt_date').value; const time = document.getElementById('m_appt_time').value; if(!patient||!date||!time){alert('Preencha os campos');return;} apiCreateAppointment({patient,professional:prof,date,time,service:'Consulta',status:'CONFIRMADO'}); closeModal('appt'); renderDashboard(); renderAgendaAll(); }
function editAppt(id){ alert('Editar agendamento (mock): '+id); }

/* --------- QUICK SEARCH --------- */
function quickSearch(){ const q = document.getElementById('quickSearch').value.toLowerCase(); // filter patients and appointments
  // show simple alert with matches
  if(!q) return; const pats = DB.patients.filter(p=>p.name.toLowerCase().includes(q)).map(p=>p.name);
  const appts = DB.appointments.filter(a=>a.patient.toLowerCase().includes(q)).map(a=>a.patient+' ('+a.date+' '+a.time+')');
  console.log('Search',pats,appts);
}

// init
if(isAuthenticated()){ showApp(); } else { document.getElementById('loginPage').style.display='flex'; document.getElementById('app').style.display='none'; }

</script>
</body>
</html>
